<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./css/main.css"/>
    <script type="text/javascript">   
    var feedInfo;
    var entries = [];

    /******** ENTRY OBJECTS ************/
    var Entry = function (content) {
      this.content = content;
    }

    Entry.prototype.createEntry = function () {
      var div = document.createElement('div');
      var clearfix = document.createElement('div');
      var heading = document.createElement('h1');
      var img = document.createElement('img');
      var time = document.createElement('time');
      var summary = document.createElement('summary');

      summary.className = 'entrySummary'
      div.className = 'entry';
      clearfix.className = 'clearfix';
      
      heading.appendChild(document.createTextNode(this.content.title));
      img.src = this.content.mediaGroups[0].contents[0].thumbnails[0].url;
      time.appendChild(document.createTextNode(this.content.publishedDate));
      summary.appendChild(document.createTextNode(this.content.contentSnippet));
      div.appendChild(heading);
      div.appendChild(time);
      div.appendChild(img);
      div.appendChild(summary);
      div.appendChild(clearfix);
      return div;
    }



    /********* ADD ENTRIES TO DOM *********/
    var initialize = function () {
      var feedUrl = "http://feeds.feedburner.com/tedtalks_video"
      var entryCount = 20;
      var feed = new google.feeds.Feed(feedUrl);
      feed.setNumEntries(entryCount);
      
      feed.load(function(result) {

        if (!result.error) {
          results = result.feed;
          // var h1 = document.createElement('h1');
          // var summary = document.createElement('summary');
          // summary.className = 'headSummary';
          // h1.className = 'aside';
          // summary.appendChild(document.createTextNode(results.description));
          // h1.appendChild(document.createTextNode(results.title));
          // $('#feedInfo').append(h1);
          // $('#feedInfo').append(summary);

          // var container = document.getElementById("feed");
          // for (var i = 0; i < result.feed.entries.length; i++) {
          //   var entry = new Entry(result.feed.entries[i]);
          //   entries.push(entry);
          //   container.appendChild(entry.createEntry());
          // }
        }

        // $('#feed .entry').click(function(e){
        // //handler for each entry;
        //   console.log($(this).index())
        // })
      });

    }


    /******** INVOCATION *********/
    google.load("feeds", "1");
    google.setOnLoadCallback(initialize);

    </script>
    <script src="./app/app.js"></script>

  </head>
  <body ngApp='feedApp'>
    <div class="container-fluid" ng-controller="feedLoader">
      <div class="row">
        <div class="col-md-8 col-sm-1" id="feed">
          <div class="entry" ng-repeat='entry in entries'>
            <h1>{{ entry.title }}</h1>
            <time>{{ entry.publishedDate }}</time>
            <!-- <img src="{{ entry.mediaGroups[0].contents[0].thumbnails[0].url}}"></img> -->
            <summary class="entrySummary"></summary>
            <div class="clearfix"></div>
          </div>
        </div>
        <div class="col-md-4 col-sm-1" id="feedInfo">
          <h1 class="aside">{{ results.title }}</h1>
          <summary class="headSummary">{{ results.description }}</summary>
        </div>
      </div>
    </div>

    <div class="container-fluid single">
      <div class="row">
        <h1></h1>
        <summary></summary>
        <video></video>
      </div>
    </div>
  </body>
</html>